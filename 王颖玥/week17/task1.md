### BERT4Rec 等推荐系统模型的缺点

- 无法利用物品的内容信息，也很难发挥大语言模型的强大语言能力；
- 面对新的物品或物品库存的动态变化无法适应
- 很难解释用户到底喜欢什么，导致了推荐结果同质化；

### GPT4Rec 实施过程

1. 提示题的构造

   ```
   Previously, the customer has bought: 
   <ITEM TITLE 1>, <ITEM TITLE 2>, ...
   In the future, the customer wants to buy:
   ```

   <ITEM TITLE 1>  为历史的物品名称

2. 模型微调与查询生成

   - 第一步中提示词为模版，用户前T-1个商品标题 + 第T个商品标题构成训练语料，微调预训练的GPT-2模型，使模型具备生成查询的能力；
   - 通过多查询束搜索技术，生成多个代表用户兴趣的查询，用生成得分函数给每个查询打分，优先保留得分高的查询

3. 物品检索

   将生成的查询输入BM25搜索引擎，按查询生成得分排序，依次从每个查询结果中选取K/m个不重复商品，K为推荐总数，m为查询数，组合为最终推荐列表

4. 训练两步策略

   - 语言模型优化：微调GPT-2模型
   - 搜索引擎优化：再通过网格搜索优化BM25的k<sub>1</sub> 和b参数