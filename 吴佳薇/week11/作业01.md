1.数据管理接口
  
    1.1知识库管理接口
    
        1.1.1创建知识库
            POST /api/v1/knowledge-bases
            请求参数：
            {
                "name": str,                        # 知识库名称（必填）
                "description": str,                 # 知识库描述（可选）
                "user_id": str,                     # 创建者用户ID（必填）
                "tags": List[str],                  # 标签列表（可选）
                "permission_config": {              # 权限配置（可选）
                    "public_read": bool,            # 是否公开可读
                    "allowed_users": List[str],     # 允许访问的用户ID列表
                    "allowed_roles": List[str]      # 允许访问的角色列表
                },
                "storage_config": {                 # 存储配置（可选）
                    "max_documents": int,           # 最大文档数量
                    "max_storage_size": int         # 最大存储大小（MB）
                }
            }
            
            返回结果：
            {
                "code": int,
                "message": str,
                "data": {
                    "knowledge_base_id": str,       # 知识库唯一ID
                    "name": str,                    # 知识库名称
                    "description": str,             # 描述
                    "creator_id": str,              # 创建者ID
                    "created_time": str,            # 创建时间
                    "document_count": int,          # 文档数量（初始为0）
                    "total_size": int,              # 总大小（字节，初始为0）
                    "permission_config": dict,      # 权限配置
                    "storage_config": dict          # 存储配置
                }
            }

            
        1.1.2查询知识库列表
            GET /api/v1/knowledge-bases
            请求参数（Query Parameters）：
            - user_id: str (必填)                 # 用户ID，用于权限过滤
            - page: int = 1                       # 页码，默认1
            - page_size: int = 20                 # 每页大小，默认20
            - search_keyword: str (可选)          # 搜索关键词（按名称/描述搜索）
            - sort_by: str = "created_time"       # 排序字段：created_time/name/document_count
            - sort_order: str = "desc"            # 排序顺序：asc/desc
            
            返回结果：
            {
                "code": int,
                "message": str,
                "data": {
                    "knowledge_bases": [
                        {
                            "knowledge_base_id": str,
                            "name": str,
                            "description": str,
                            "creator_id": str,
                            "created_time": str,
                            "updated_time": str,
                            "document_count": int,      # 文档总数
                            "total_size": int,          # 总大小（字节）
                            "last_document_time": str,  # 最后上传文档时间
                            "permission_config": dict,  # 权限配置
                            "can_edit": bool,           # 当前用户是否有编辑权限
                            "can_delete": bool          # 当前用户是否有删除权限
                        }
                    ],
                    "pagination": {
                        "current_page": int,
                        "page_size": int,
                        "total_count": int,
                        "total_pages": int
                    }
                }
            }


        1.1.3查询知识库详情
            GET /api/v1/knowledge-bases/{knowledge_base_id}
            请求参数：
            - user_id: str (Query参数，必填)      # 用于权限验证
            
            返回结果：
            {
                "code": int,
                "message": str,
                "data": {
                    "knowledge_base_id": str,
                    "name": str,
                    "description": str,
                    "creator_id": str,
                    "created_time": str,
                    "updated_time": str,
                    "document_count": int,
                    "total_size": int,
                    "permission_config": dict,
                    "storage_config": dict,
                    "statistics": {                 # 统计信息
                        "text_chunks_count": int,   # 文本块总数
                        "images_count": int,        # 图片总数
                        "last_activity": str        # 最后活动时间
                    },
                    "documents": [                  # 文档列表（简要信息）
                        {
                            "document_id": str,
                            "name": str,
                            "upload_time": str,
                            "page_count": int,
                            "status": str,          # processing/completed/failed
                            "size": int
                        }
                    ]
                }
            }


        1.1.4更新知识库信息
            PUT /api/v1/knowledge-bases/{knowledge_base_id}
            请求参数：
            {
                "user_id": str,                     # 用户ID（必填，用于权限验证）
                "name": str,                        # 新名称（可选）
                "description": str,                 # 新描述（可选）
                "permission_config": dict,          # 新权限配置（可选）
                "storage_config": dict              # 新存储配置（可选）
            }
            
            返回结果：
            {
                "code": int,
                "message": str,
                "data": {
                    "knowledge_base_id": str,
                    "updated_fields": List[str],    # 被更新的字段列表
                    "updated_time": str
                }
            }

            
        1.1.5 删除知识库
            DELETE /api/v1/knowledge-bases/{knowledge_base_id}
            请求参数：
            {
                "user_id": str,                     # 用户ID（必填，用于权限验证）
                "confirm": bool = True              # 确认删除，防止误操作
            }
            
            返回结果：
            {
                "code": int,
                "message": str,
                "data": {
                    "deleted_knowledge_base_id": str,
                    "deleted_documents_count": int, # 同时删除的文档数量
                    "deleted_time": str,
                    "cleanup_status": str           # 清理状态：pending/completed
                }
            }



    1.2文档上传接口
  
    POST /api/v1/documents/upload
    请求参数：
    {
        "knowledge_base_id": str,           # 知识库ID
        "file": File,                       # PDF文件
        "user_id": str,                     # 用户ID（用于权限验证）
        "document_name": str,               # 文档名称（可选）
        "tags": List[str]                   # 文档标签（可选）
    }
    
    返回结果：
    {
        "code": int,                        # 状态码
        "message": str,                     # 返回信息
        "data": {
            "document_id": str,             # 文档ID
            "status": str,                  # 状态：uploaded/processing/completed/failed
            "estimated_time": int,          # 预计处理时间（秒）
            "upload_time": str              # 上传时间
        }
    }




2.多模态检索接口

    POST /api/v1/retrieve/multi-modal
    请求参数：
    {
        "query": str,                       # 用户查询文本
        "knowledge_base_ids": List[str],    # 知识库ID列表
        "top_k": int,                       # 返回结果数量，默认10
        "threshold": float,                 # 相似度阈值，默认0.5
        "modalities": List[str],            # 检索模态：["text", "image"]
        "user_id": str                      # 用户ID（权限验证）
    }
    返回结果：
    {
        "code": int,
        "message": str,
        "data": {
            "text_results": [
                {
                    "content": str,         # 文本内容
                    "document_id": str,     # 文档ID
                    "page_number": int,     # 页码
                    "chunk_id": str,        # 文本块ID
                    "similarity_score": float,  # 相似度分数
                    "metadata": dict        # 元数据（位置信息等）
                }
            ],
            "image_results": [
                {
                    "image_path": str,      # 图片存储路径
                    "document_id": str,     # 文档ID
                    "page_number": int,     # 页码
                    "image_id": str,        # 图片ID
                    "caption": str,         # 图片描述（OCR结果）
                    "similarity_score": float,  # 相似度分数
                    "bounding_box": dict    # 在页面中的位置信息
                }
            ],
            "query_embedding": List[float]  # 查询的向量表示（可选）
        }
    }




3.多模态问答接口

    POST /api/v1/chat/multi-modal
    请求参数：
    {
        "query": str,                       # 用户问题
        "knowledge_base_ids": List[str],    # 知识库ID列表
        "conversation_id": str,             # 会话ID（用于多轮对话）
        "history": List[dict],              # 对话历史
        "user_id": str,                     # 用户ID
        "retrieval_config": {               # 检索配置
            "top_k": int,
            "threshold": float,
            "modalities": List[str]
        },
        "generation_config": {              # 生成配置
            "max_length": int,
            "temperature": float,
            "include_sources": bool         # 是否包含来源
        }
    }
    返回结果：
    {
        "code": int,
        "message": str,
        "data": {
            "answer": str,                  # 生成的答案
            "sources": [                    # 答案来源
                {
                    "type": str,            # text/image
                    "content": str,         # 源内容（文本或图片描述）
                    "document_id": str,     # 文档ID
                    "document_name": str,   # 文档名称
                    "page_number": int,     # 页码
                    "source_id": str,       # 源ID（chunk_id或image_id）
                    "confidence": float,    # 置信度
                    "modality": str         # 模态类型
                }
            ],
            "conversation_id": str,         # 会话ID
            "retrieval_time": float,        # 检索耗时（秒）
            "generation_time": float,       # 生成耗时（秒）
            "total_time": float             # 总耗时
        }
    }




4.状态查询接口

    GET /api/v1/documents/{document_id}/status
    请求参数：无
    返回结果：
    {
        "code": int,
        "message": str,
        "data": {
            "document_id": str,
            "status": str,                  # processing/completed/failed
            "progress": float,              # 处理进度 0-1
            "error_message": str,           # 错误信息（如果失败）
            "parsed_pages": int,            # 已解析页数
            "total_pages": int              # 总页数
        }
    }
