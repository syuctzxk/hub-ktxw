# 作业1
## 数据管理接口
上传文档接口：POST /api/v1/documents/upload  
- 请求参数：上传的pdf文件,文档描述  
- 返回结果：{状态码，文档上传是否成功，data={文档上传时间，文档id}}

删除文档接口：DELETE /api/v1/documents/{document_id} 
- 请求参数：需要删除的文档id
- 返回结果：{状态码，文档是否删除成功}

查询文档列表接口：GET /api/v1/documents/list 
- 请求参数：无 
- 返回结果：{状态码，查询是否成功，data={文档数量，文档信息=[{文档id，文档描述，文档创建时间，文档修改时间，文档保存地址}]}}

获取文档接口：   GET /api/v1/documents/{document_id}  
- 请求参数：需要获取的文档id  
- 返回结果：{状态码，文档是否获取成功，data={文档id，文档保存地址，文档创建时间，文档修改时间，文档描述}}

更新文档接口：PATCH /api/v1/documents/{document_id}/title 
- 请求参数：需要更新的文档id,需要更换的文档描述
- 返回结果{状态码，文档是否更新成功}

查询文档的chunks接口 GET /api/v1/documents/{document_id}/chunks 
- 请求参数：需要查询的文档id，
- 返回结果{状态码，查询是否成功，data={文档id，chunk数量，chunks=[{chunk_id,chunk所属类型(文本，图，表)，chunk内容，chunk所属文档页码,chunk在向量数据库中对应的主键}}}

查询特定文档的特定chunk接口 GET /api/v1/documents/{document_id}/chunks/{chunk_id} 
- 请求参数：需要查询的文档id，需要查询的chunkid
- 返回结果：{状态码，查询是否成功，data={文档id，chunk_id，chunk所属类型（文本，图，表），chunk文本内容，chunk所属文档页码，chunk在向量数据库中对应的主键}}

## 多模态检索接口
- 请求参数：请求文本，请求图片的base64编码，最大检索chunk数量，检索类型
- 返回结果：{状态码，检索是否成功，results=[{chunk_id,chunk内容，chunk所属类型（文本，图，表），chunk所属文档页码，chunk所属文档id，chunk在向量数据库中的主键，相似度得分}]}

## 多模态问答接口
- 请求参数：问答文本，问答图片，所用模型
- 返回结果：{状态码，是否成功回答，results={大模型输出的答案，使用的参考文本内容，图片或表格，参考内容所属文档id，参考内容所属文档页码}}

# 作业2
## 用户使用【文本】提问
将文本编码为向量去向量数据库中检索相关chunk，直接用文本去进行全文检索，综合两者得到的chunk进行重排序后返回对应的参考文本内容和图，然后结合大模型进行回答。
## 用户使用【文本+图】提问
将图解析为文本内容，直接用图解析后的文本内容结合原来的文本内容去进行全文检索，将图和文本分别编码为向量，然后将其融合为多模态向量去向量数据库进行检索，最后综合两者返回的chunk进行重排序，得到最后返回的对应的参考文本内容和图，然后结合大模型进行回答。
## 区别
使用【文本+图】的提问方式的话需要进行模态的融合，需要将两者均编码为向量后，然后融合为多模态向量去向量数据库进行检索。而单使用文本提问的话，只需要进行单模态检索，只需将原文本编码为向量后，直接去向量数据库中进行检索即可。

# 作业3
- milvus_primary_key：主键，对应到关系数据库中的每个chunk
- content：chunk文本内容（原始文本内容，图和表格解析后的文本内容）
- type：chunk所属类型（文本，图，表）
- text_vector：chunk文本内容编码后的向量
- image_vector：chunk图片用clip模型编码后的向量
- multimodal_vector：将图片解析为文本后用clip模型编码为text_embedding，将图片本身用clip模型编码为image_embedding，然后将两者进行融合

直接提取表的文本内容和对表解析后的文本内容进行编码即可，没必要将表结构本身编码为向量
